---
title: "Integratio Tecniosperm"
author: "Francisco Madrid"
date: '`r format(Sys.time(), "%B %d, %Y,%H:%M")`'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(mixOmics)
library(tidyr)
library(ggraph)
library(igraph)
library(tidyverse)
library(RColorBrewer)


# library(showtext)
# showtext_auto()
# font_add_google("Roboto", "Roboto")

# load("C:/Users/Biosignal/Documents/IMIM/Tecniosperm2/Integration.RData")
```



## Data loading

```{r}
sperm <- read.csv("C:/Users/Biosignal/Documents/IMIM/Tecniosperm/DATA_final_FMG.csv")

data <- sperm[,2:22]
meta <- sperm[,c(1,23:length(sperm))]
```


## Imputing data (zeros)

```{r}
xdata <- data
has.neg <- apply(xdata, 1, function(row) any(row < 0))
# which(has.neg)
message("there are ", length(which(has.neg)), " rows with negative values")

## Detected abnormal 0 values
xdata[xdata == 0] <- NA

for(i in 1:ncol(xdata)){
  xdata[is.na(xdata[,i]), i] <- min(xdata[,i], na.rm = TRUE)/2}

# message("there are ", sum(is.na(xdata)), " NAs")
# has.neg <- apply(xdata, 1, function(row) any(row < 0))
# message("there are ", length(which(has.neg)), " rows with negative values")

data <- xdata
sperm[,2:22] <- data
rm(xdata)
```


```{r}
data <- data %>% dplyr::mutate(Cit_LA = Citricacid/Lacticacid)

data <- data %>% dplyr::select(
  -Hippuricacid,
  -Phenylalanine,
  -Tryptophan
)
```


## Normalizacion

```{r}
normalize<-function(data,vars=colnames(data),group_var,method){
  subdata<-data[,vars]
  subdata<-switch(method,
                  auto=apply(subdata,2,function(x) (x-mean(x,na.rm=T))/sd(x,na.rm=T)),        
                  level=apply(subdata,2,function(x) (x-mean(x,na.rm=T))/mean(x,na.rm=T)),
                  log=apply(subdata,2,function(x) (log10(x+1)-mean(log10(x+1),na.rm=T))/sd(log10(x+1),na.rm=T)),
                  vast=apply(subdata,2,function(x) ((x-mean(x,na.rm=T))/sd(x,na.rm=T))*(mean(x,na.rm=T)/sd(x,na.rm=T))),         
                  logpareto=apply(subdata,2,function(x) (log10(x+1)-mean(log10(x+1),na.rm=T))/sqrt(sd(log10(x+1),na.rm=T))),
                  pareto=apply(subdata,2,function(x) (x-mean(x,na.rm=T))/sqrt(sd(x),na.rm=T))
  )
  data[,vars]<-subdata
  return(data)
}


dataNorm <- normalize(data, method = "logpareto")
```


## N-block_PLS

```{r}
fecundante <- c("Id", "Fertilization_rate_D2", "D6_PCT_embrios_total", "D6_PCT_Morula_Total", "D6_PCT_Blastos_Total", "D6_PCT_Hatched_Total", "D6_PCT_MorulaBlastosHatched_Total", "D6_Taxa_desenvolupamentnum.Morblashatchentrenum.2cel8cel.Mesgran", "D6_Taxa_desenvolupament_dia26")

calidad <- c("Id", "DIL_T0_TOTAL", "DIL_T0_PROGESSIUS", "PCT_MORF_NORMAL", "DIL_T0_PCT_VIABLE")

funcion <- c("Id", "DIL_RATIO_PCT_LIVE_PNAneg", "DIL_RATIO_MA_LIVE_F3pos", "DIL_RATIO_PCT_JC1_HMMP")

all <- c(calidad, funcion[-1], fecundante[-1])

meta_funcion <- meta[, all]
```


```{r}
X <- list(Metabolomics = as.matrix(dataNorm),
          `Sperm Quality` = as.matrix(meta[, calidad[-1]]),
          `Sperm Function` = as.matrix(meta[, funcion[-1]]),
          `Fertilizing Capacity` = as.matrix(meta[, fecundante[-1]])
          )

# Y <- as.matrix(pca_funcion[["variates"]][["X"]])

# 
# list.keepX <- list(
#   Metabolomics = c(80,  124), 
#   FC = c(4, 4)
#   )

block.pls.result <- block.pls(X, indY = 4, 
                             # keepX = list.keepX,
                             scale = TRUE, 
                             mode = "regression"
                             # scheme ="factorial"
)

block.pls.result <- block.pls(X, indY = 4, 
                             # keepX = list.keepX,
                             scale = TRUE, 
                             mode = "regression"
                             # scheme ="factorial"
)

plotIndiv(block.pls.result, 
          ind.names = FALSE, 
          legend=TRUE, 
          # cex=c(1,2), 
          # col.per.group = c("blue", "red"),
          title = "")

plotVar(block.pls.result, legend = TRUE) # plot the variables

```




```{r}
block.pls.result$design
```


```{r}
cor1 <- cor(block.pls.result$variates$Metabolomics, block.pls.result$variates$`Sperm Quality`)
rownames(cor1) <- c("comp1_metabolomics","comp2_metabolomics")
colnames(cor1) <- c("comp1_Sperm_Quality","comp2_Sperm_Quality")

cor2 <- cor(block.pls.result$variates$Metabolomics, block.pls.result$variates$`Sperm Function`) 
rownames(cor2) <- c("comp1_metabolomics","comp2_metabolomics")
colnames(cor2) <- c("comp1_Sperm_Function","comp2_Sperm_Function")

cor3 <- cor(block.pls.result$variates$Metabolomics, block.pls.result$variates$`Fertilizing Capacity`)
rownames(cor3) <- c("comp1_metabolomics","comp2_metabolomics")
colnames(cor3) <- c("comp1_Fertilizing_Capacity","comp2_Fertilizing_Capacity")

cor4 <- cor(block.pls.result$variates$`Sperm Quality`, block.pls.result$variates$`Sperm Function`)
rownames(cor4) <- c("comp1_Sperm_Quality","comp2_Sperm_Quality")
colnames(cor4) <- c("comp1_Sperm_Function","comp2_Sperm_Function")

cor5 <- cor(block.pls.result$variates$`Sperm Quality`, block.pls.result$variates$`Fertilizing Capacity`)
rownames(cor5) <- c("comp1_Sperm_Quality","comp2_Sperm_Quality")
colnames(cor5) <- c("comp1_Fertilizing_Capacity","comp2_Fertilizing_Capacity")

cor6 <- cor(block.pls.result$variates$`Sperm Function`, block.pls.result$variates$`Fertilizing Capacity`)
rownames(cor6) <- c("comp1_Sperm_Function","comp2_Sperm_Function")
colnames(cor6) <- c("comp1_Fertilizing_Capacity","comp2_Fertilizing_Capacity")

cor1
cor2
cor3
cor4
cor5
cor6
```

```{r}
correlation_Components <- cbind(as.data.frame(cor1), as.data.frame(cor2))
correlation_Components <- cbind(as.data.frame(correlation_Components), as.data.frame(cor3))

write.csv(correlation_Components, "correlation_Components.csv",row.names = TRUE)
write.csv(cor4, "cor4.csv",row.names = TRUE)
write.csv(cor5, "cor5.csv",row.names = TRUE)
write.csv(cor6, "cor6.csv",row.names = TRUE)
```




Another visualisation of the correlation between the different types of variables is the relevance network, which is also built on the similarity matrix (González et al. 2012). Each colour represents a type of variable. A threshold can also be set using the argument cutoff.
```{r}
corPlot3 <- network(block.pls.result, 
                    blocks = c(1,2,3,4),
        # color.node = c('darkorchid', 
                       # 'brown1' 
                       # 'lightgreen'
                       # ), 
        cutoff = 0.3, 
        save = 'jpeg', 
        name.save = 'blocPLS3'
        )

M_Metabolomics_Sperm_Quality <- corPlot3$`M_Metabolomics_Sperm Quality` # M is the correlation m used for the network
M_Metabolomics_Sperm_Function <- corPlot3$`M_Metabolomics_Sperm Function`
M_Metabolomics_Fertilizing_Capacity <- corPlot3$`M_Metabolomics_Fertilizing Capacity`
M_Sperm_Quality_Sperm_Function <- corPlot3$`M_Sperm Quality_Sperm Function`
M_Sperm_Quality_Fertilizing_Capacity <- corPlot3$`M_Sperm Quality_Fertilizing Capacity`
M_Sperm_Function_Fertilizing_Capacity <- corPlot3$`M_Sperm Function_Fertilizing Capacity`
```


## Extraer el grafico de la network

```{r}
library(igraph)

corNet = corPlot3$gR
write.graph(corNet, 
            file="blockPLS03.graphML", format="graphML")
```


## Pintar la network en sucio. Checar

```{r}
# tkplot(corNet)

rglplot(corNet)

plot.igraph(corNet)

library("networkD3")
library("htmlwidgets")
```



```{r}
M_Metabolomics_Sperm_Quality <- as.data.frame(M_Metabolomics_Sperm_Quality)
M_Metabolomics_Sperm_Quality$from <- rownames(M_Metabolomics_Sperm_Quality)

M_Metabolomics_Sperm_Function <- as.data.frame(M_Metabolomics_Sperm_Function)
M_Metabolomics_Sperm_Function$from <- rownames(M_Metabolomics_Sperm_Function)

M_Metabolomics_Fertilizing_Capacity <- as.data.frame(M_Metabolomics_Fertilizing_Capacity)
M_Metabolomics_Fertilizing_Capacity$from <- rownames(M_Metabolomics_Fertilizing_Capacity)

M_Sperm_Quality_Sperm_Function <- as.data.frame(M_Sperm_Quality_Sperm_Function)
M_Sperm_Quality_Sperm_Function$from <- rownames(M_Sperm_Quality_Sperm_Function)

M_Sperm_Quality_Fertilizing_Capacity <- as.data.frame(M_Sperm_Quality_Fertilizing_Capacity)
M_Sperm_Quality_Fertilizing_Capacity$from <- rownames(M_Sperm_Quality_Fertilizing_Capacity)

M_Sperm_Function_Fertilizing_Capacity <- as.data.frame(M_Sperm_Function_Fertilizing_Capacity)
M_Sperm_Function_Fertilizing_Capacity$from <- rownames(M_Sperm_Function_Fertilizing_Capacity)
```


```{r}
connect_1 <- M_Metabolomics_Sperm_Quality %>% pivot_longer(!from, names_to = "to", values_to = "value")
connect_1 <- connect_1[connect_1$value != 0,]

connect_2 <- M_Metabolomics_Sperm_Function %>% pivot_longer(!from, names_to = "to", values_to = "value")
connect_2 <- connect_2[connect_2$value != 0,]

connect_3 <- M_Metabolomics_Fertilizing_Capacity %>% pivot_longer(!from, names_to = "to", values_to = "value")
connect_3 <- connect_3[connect_3$value != 0,]

connect_4 <- M_Sperm_Quality_Sperm_Function %>% pivot_longer(!from, names_to = "to", values_to = "value")
connect_4 <- connect_4[connect_4$value != 0,]

connect_5 <- M_Sperm_Quality_Fertilizing_Capacity %>% pivot_longer(!from, names_to = "to", values_to = "value")
connect_5 <- connect_5[connect_5$value != 0,]

connect_6 <- M_Sperm_Function_Fertilizing_Capacity %>% pivot_longer(!from, names_to = "to", values_to = "value")
connect_6 <- connect_6[connect_6$value != 0,]

connect_Z <- rbind(connect_1, connect_2, connect_3, connect_4, connect_5, connect_6)

# range01 <- function(x){(x-min(x))/(max(x)-min(x))}
# connect_Z$value <- range01(connect_Z$value)

# connect_Z <- connect_Z[order(connect_Z$from),]
```


## Cuidado

Los espacios en las variables peta el grafico

```{r}
from <- connect_Z$from

from <- str_replace_all(from, "_Metabolomics", "")
from <- str_replace_all(from, "_Sperm Quality", "")
from <- str_replace_all(from, "_Sperm Function", "")
from <- str_replace_all(from, "_Fertilizing Capacity", "")

connect_Z$from <- from

to <- connect_Z$to

to <- str_replace_all(to, "_Metabolomics", "")
to <- str_replace_all(to, "_Sperm Quality", "")
to <- str_replace_all(to, "_Sperm Function", "")
to <- str_replace_all(to, "_Fertilizing Capacity", "")

connect_Z$to <- to
```


```{r}
from <- connect_Z$from

from <- str_replace_all(from, "Lacticacid", "Lactate")
from <- str_replace_all(from, "Citricacid", "Citrate")
from <- str_replace_all(from, "Isocitricacid", "Isocitrate")
from <- str_replace_all(from, "aKetoglutarate", "alpha-Ketoglutarate")
from <- str_replace_all(from, "Succinicacid", "Succinate")
from <- str_replace_all(from, "Fumaricacid", "Fumarate")
from <- str_replace_all(from, "Malicacid", "Malate")
from <- str_replace_all(from, "Acetoacetate", "Acetoacetate")
from <- str_replace_all(from, "Cit_LA", "Citrate/Lactate")
from <- str_replace_all(from, "iCit_Cit", "Isocitrate/Citrate")
from <- str_replace_all(from, "aKG_iCit", "alpha-Ketoglutarate/Citrate")
from <- str_replace_all(from, "Fum_Suc", "Fumarate/Succinate")
from <- str_replace_all(from, "Mal_Suc", "Malate/Succinate")
from <- str_replace_all(from, "Cit_Mal", "Citrate/Malate")
from <- str_replace_all(from, "OHGlut_iCit", "alpha-OH-glutarate/Isocitrate")
from <- str_replace_all(from, "OHGlut_aKG", "alpha-OH-/alpha-Ketoglutarate")
from <- str_replace_all(from, "DIL_T0_TOTAL", "Total Motility")
from <- str_replace_all(from, "DIL_T0_PROGESSIUS", "Progressive Motility")
from <- str_replace_all(from, "PCT_MORF_NORMAL", "Sperm w/ normal morphology")
from <- str_replace_all(from, "DIL_T0_PCT_VIABLE", "Viable sperm")
from <- str_replace_all(from, "DIL_RATIO_PCT_LIVE_PNAneg", "Viable sperm w/ intact acrosome")
from <- str_replace_all(from, "DIL_RATIO_MA_LIVE_F3pos", "Intracellular calcium levels")
from <- str_replace_all(from, "DIL_RATIO_PCT_JC1_HMMP", "Sperm mitochondrial potential")
from <- str_replace_all(from, "Fertilization_rate_D2", "Fertilisation Rate")
from <- str_replace_all(from, "D6_PCT_embrios_total", "Total embryos")
from <- str_replace_all(from, "D6_PCT_Morula_Total", "Morulae")
from <- str_replace_all(from, "D6_PCT_Blastos_Total", "Early blastocyst/blastocyst")
from <- str_replace_all(from, "D6_PCT_Hatched_Total", "Hatching/Hatched blastocyst")
from <- str_replace_all(from, "D6_PCT_MorulaBlastosHatched_Total", "Morulae and total blastocyst")
from <- str_replace_all(from, "D6_Taxa_desenvolupamentnum.Morblashatchentrenum.2cel8cel.Mesgran", "Developmental ratio")
from <- str_replace_all(from, "D6_Taxa_desenvolupament_dia26", "Developmental competency fertilised oocyte")

connect_Z$from <- from
#######################################

to <- connect_Z$to

to <- str_replace_all(to, "Lacticacid", "Lactate")
to <- str_replace_all(to, "Citricacid", "Citrate")
to <- str_replace_all(to, "Isocitricacid", "Isocitrate")
to <- str_replace_all(to, "aKetoglutarate", "alpha-Ketoglutarate")
to <- str_replace_all(to, "Succinicacid", "Succinate")
to <- str_replace_all(to, "Fumaricacid", "Fumarate")
to <- str_replace_all(to, "Malicacid", "Malate")
to <- str_replace_all(to, "Acetoacetate", "Acetoacetate")
to <- str_replace_all(to, "Cit_LA", "Citrate/Lactate")
to <- str_replace_all(to, "iCit_Cit", "Isocitrate/Citrate")
to <- str_replace_all(to, "aKG_iCit", "alpha-Ketoglutarate/citrate")
to <- str_replace_all(to, "Fum_Suc", "Fumarate/Succinate")
to <- str_replace_all(to, "Mal_Suc", "Malate/Succinate")
to <- str_replace_all(to, "Cit_Mal", "Citrate/Malate")
to <- str_replace_all(to, "OHGlut_iCit", "alpha-OH-/Isocitrate")
to <- str_replace_all(to, "OHGlut_aKG", "alpha-OH-/alpha-Ketoglutarate")
to <- str_replace_all(to, "DIL_T0_TOTAL", "Total Motility")
to <- str_replace_all(to, "DIL_T0_PROGESSIUS", "Progressive Motility")
to <- str_replace_all(to, "PCT_MORF_NORMAL", "Sperm w/ normal morphology")
to <- str_replace_all(to, "DIL_T0_PCT_VIABLE", "Viable sperm")
to <- str_replace_all(to, "DIL_RATIO_PCT_LIVE_PNAneg", "Viable sperm w/ intact acrosome")
to <- str_replace_all(to, "DIL_RATIO_MA_LIVE_F3pos", "Intracellular calcium levels")
to <- str_replace_all(to, "DIL_RATIO_PCT_JC1_HMMP", "Sperm mitochondrial potential")
to <- str_replace_all(to, "Fertilization_rate_D2", "Fertilisation Rate")
to <- str_replace_all(to, "D6_PCT_embrios_total", "Total embryos")
to <- str_replace_all(to, "D6_PCT_Morula_Total", "Morulae")
to <- str_replace_all(to, "D6_PCT_Blastos_Total", "Early blastocyst/blastocyst")
to <- str_replace_all(to, "D6_PCT_Hatched_Total", "Hatching/Hatched blastocyst")
to <- str_replace_all(to, "D6_PCT_MorulaBlastosHatched_Total", "Morulae and total blastocyst")
to <- str_replace_all(to, "D6_Taxa_desenvolupamentnum.Morblashatchentrenum.2cel8cel.Mesgran", "Developmental ratio")
to <- str_replace_all(to, "D6_Taxa_desenvolupament_dia26", "Developmental competency fertilised oocyte")

connect_Z$to <- to
```


## Edges

```{r}
edges2 <- read.csv("C:/Users/Biosignal/Documents/IMIM/Tecniosperm2/integracion_tecniosperm/edges2_OH.csv")

# togreek=function(compname) {
#   n=as.character(compname,encoding="UTF-8")
#   n=gsub("alpha","\u03B1",n)
#   n
# }
# edges$to <- togreek(edges$to)

# to <- str_replace_all(to, "Sperm mitochondrial potential", "Sperm mitochondrial potential    .")
# to <- str_replace_all(to, "Developmental competency \n fertilised oocytes", "Developmental competency \n fertilised oocytes    .")
# 
# edges$to <- to
##############
# from <- edges$from
# from <- str_replace_all(from, "Fertilizing Capacity", "Fertilizing Capacity  .")
# edges$from <- from

# create a vertices data.frame. One line per object of our hierarchy
vertices  <-  data.frame(
  name = unique(c(as.character(edges2$from), as.character(edges2$to))), 
  value = runif(36)
) 

# Let's add a column with the group of each name. It will be useful later to color points
vertices$group  <-  edges2$from[ match(vertices$name, edges2$to) ]
```



```{r}
#Let's add information concerning the label we are going to add: angle, horizontal adjustement and potential flip
#calculate the ANGLE of the labels
vertices$id <- NA
myleaves <- which(is.na(match(vertices$name, edges2$from)))
nleaves <- length(myleaves)
vertices$id[ myleaves ] <- seq(1:nleaves)
vertices$angle <- 90 - 360 * vertices$id / nleaves
 
# calculate the alignment of labels: right or left
# If I am on the left part of the plot, my labels have currently an angle < -90
vertices$hjust <- ifelse(vertices$angle < -90, 1, 0)
 
# flip angle BY to make them readable
vertices$angle <- ifelse(vertices$angle < -90, vertices$angle+180, vertices$angle)
```


```{r fig.height=10, fig.width=10, warning=FALSE}
size <- rep(0.2, length(vertices$value)-1)
size <- c(0.88, size)

size <- sort(runif(length(vertices$value)))
  
# Create a graph object
mygraph <- igraph::graph_from_data_frame(edges2[,c("from", "to")], vertices=vertices)
 
# The connection object must refer to the ids of the leaves:
from  <-  match(connect_Z$from, vertices$name)
to  <-  match(connect_Z$to, vertices$name)
 
# Basic usual argument
ggraph(mygraph, layout = 'dendrogram', circular = TRUE) + 
  geom_node_point(aes(filter = leaf, x = x, y=y, size = size)) +
  geom_conn_bundle(data = get_con(from = from, to = to), alpha=0.2, colour="skyblue", width=0.9, tension = 1) +
  geom_node_text(aes(x = x*1.1, y=y*1.1, filter = leaf, label= name, angle = angle, hjust=hjust), size=2.5, alpha=1) +
  theme_void() +
  theme(
    legend.position="none",
    plot.margin=unit(c(0,0,0,0),"cm"),
  ) +
  expand_limits(x = c(-1.2, 1.2), y = c(-1.2, 1.2))
```


Grabamos para desplazar el ángulo y el hjust a ojímetro porque el plot ordena las variables como le da la gana y se descuadran. En este caso, el metabolito que marca la vertical es MAGDAG182, así que comenzaremos el ~90º en este metabolito.

```{r}
write.csv(vertices, paste0(getwd(),"/integracion_tecniosperm/vertices_provisional_OH.csv"), row.names = FALSE)
```


Modify the vertices file cutting and pasting the **angle and hjust** into the metabolite in the top of the plot. Then reload.

```{r}
vertices <- read.csv(paste0(getwd(),"/integracion_tecniosperm","/vertices_corrected_OH.csv"))

# vertices$name <- togreek(vertices$name)
```



```{r}
# Create a graph object
mygraph <- igraph::graph_from_data_frame(edges2[,c("from", "to")], vertices=vertices)
 
# The connection object must refer to the ids of the leaves:
from  <-  match(connect_Z$from, vertices$name)
to  <-  match(connect_Z$to, vertices$name)
```



```{r eval=FALSE, include=FALSE}
library(showtext)
showtext_auto()
font_add_google("Roboto", "Roboto")
```


```{r, fig.height=9, fig.width=9}
degree.layout <- edges2[, c("to", "degree.layout")]
colnames(degree.layout)[1] <- "name"

size.node <- merge(vertices[-2], degree.layout, by = "name", all = TRUE)
size.node <- size.node[match(vertices$name, size.node$name),]

colorines <- rep(brewer.pal(8,"Paired")[c(2,6,4,8)], 31)
# colorines <- str_replace(colorines, "#FFFF99", "#795644")
col <- connect_Z$value

  ## Añadir legenda color manualmente
colors_manual <- c("Positive" = "darkblue", "Negative" = "yellow")

Plot.dendo <- ggraph(mygraph, layout = 'dendrogram', circular = TRUE) + 
  # geom_conn_bundle(data = get_con(from = from, to = to), alpha=0.2, width=0.9, tension = 0.7, aes(colour= ..index..)) +
  geom_conn_bundle(data = get_con(from = from, to = to, col = col), alpha=0.2, width=0.9, tension = 0.7, 
                   aes(colour = col, alpha = col, width = col)) +

  # scale_edge_colour_distiller(palette = "RdPu", guide = "none") +
    scale_edge_color_continuous(low="yellow", high="#4A148C", 
                                limits  = c(-1, 1) ## MUY IMPORTANTE limits para colore en correlaciones
                                ) +

  geom_node_text(aes(x = x*1.05, y=y*1.05, filter = leaf, label= name, 
                     angle = angle, hjust=hjust, colour=group), ## excel vertices
                 size=3, 
                 # alpha=1
                 ) +
  
  geom_node_point(aes(filter = leaf, x = x*0.98, y=y*0.98, colour=group, 
                      size=size.node$degree.layout*4, 
                      alpha=0.2)) +
  scale_colour_manual(values= colorines) +
  # scale_size_continuous(range = c(0.1,10), guide = "none") + 
  
  theme_void() +
  theme(
    # legend.position="none",
    plot.margin=unit(c(0,0,0,0),"cm"),
  ) +
  expand_limits(x = c(-2.5, 2.5), y = c(-2.5, 2.5)) ## Ajustar encuadre
```


```{r, fig.height=6.2, fig.width=7.75}
Plot.dendo + guides(size="none", alpha="none", values="none", index="none", range = "none")

```


```{r, fig.height=6.2, fig.width=7.75}
Plot_OH <- Plot.dendo + guides(size="none", alpha="none", values="none", index="none", range = "none")

ggsave(Plot_OH, filename = "cosa.jpg", path = getwd(),
       width = 7.75,
       height = 6.2,
       device='jpg', dpi=700)
```








